<!DOCTYPE html>
<html>

<head>
  <title><%= car._id ? 'Редагувати' : 'Додати авто' %></title>
  <link rel="stylesheet" href="/stylesheets/style.css" />
</head>
<script src="/javascript/filePlaceholder.js"></script>

<body>
  <%-include('../components/header',{activePage:'cars'}) %>

  <main>
    <div class="form-container">
      <h1 class="form-title">
        <%= car._id? 'Редагувати авто' : 'Додати нове авто' %>
      </h1>


      <form action="<%=car._id?`/cars/update/${car._id}`:'/cars/create'%>" method="post" enctype="multipart/form-data">
        <div class="form-group">
          <label for="title">Назва (марка)</label>
          <input type="text" _id="title" name="title" value="<%= car.title  %>" placeholder="Марку авто"  />
          <% if(errors && errors.length > 0){ %>
          <% errors.forEach(error => { %>
          <% if(error.path[0] === 'title'){ %>
          <small class="error-message"><%= error.message %></small>
          <% } %>
          <% }) %>
          <% } %>
        </div>

        <div class="form-group">
          <label for="year">Рік</label>
          <input type="number" _id="year" name="year" value="<%= car.year  %>" placeholder="Введіть рік авто" />
          <% if(errors && errors.length > 0){ %>
          <% errors.forEach(error => { %>
          <% if(error.path[0] === 'year'){ %>
          <small class="error-message"><%= error.message %></small>
          <% } %>
          <% }) %>
          <% } %>
        </div>

        <div class="form-group">
          <label for="plateNumber">Реєстраційний номер</label>
          <input type="text" _id="plateNumber" name="plateNumber" value="<%= car.plateNumber  %>" placeholder="AA 1234 BB" />
          <% if(errors && errors.length > 0){ %>
          <% errors.forEach(error => { %>
          <% if(error.path[0] === 'plateNumber'){ %>
          <small class="error-message"><%= error.message %></small>
          <% } %>
          <% }) %>
          <% } %>
        </div>

        <div class="form-group">
          <label for="description">Опис</label>
          <textarea _id="description" name="description" rows="6" placeholder="Введіть опис автомобіля..."><%= car.description  %></textarea>
          <% if(errors && errors.length > 0){ %>
          <% errors.forEach(error => { %>
          <% if(error.path[0] === 'description'){ %>
          <small class="error-message"><%= error.message %></small>
          <% } %>
          <% }) %>
          <% } %>
        </div>

        <div class="form-group">
          <div>
            <label for="image">Фото</label>
            <input type="file" name="image" value="<%=car.image  %>" accept="=image/" onchange="handleImageInput(event)">
          </div>

          <div>
            <img id="carImage" src="<%= car.image ? car.image : '/images/photo-not-available.jpg' %>" alt="placeholder">
          </div>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn-submit">
            <%= car._id? ' Зберегти зміни' : ' Створити авто' %>
          </button>
          <a href="/cars" class="btn-cancel">Скасувати</a>
        </div>
      </form>
    </div>
  </main>
  <%-include('../components/footer') %>
</body>

</html>